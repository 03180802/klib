

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>klib.describe &mdash; klib 0.0.89 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> klib
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install and contribution</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">klib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>klib.describe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for klib.describe</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for descriptive analytics.</span>

<span class="sd">:author: Andreas Kanz</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">klib.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_corr_selector</span><span class="p">,</span>
    <span class="n">_missing_vals</span><span class="p">,</span>
    <span class="n">_validate_input_bool</span><span class="p">,</span>
    <span class="n">_validate_input_int</span><span class="p">,</span>
    <span class="n">_validate_input_smaller</span><span class="p">,</span>
    <span class="n">_validate_input_range</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cat_plot&quot;</span><span class="p">,</span> <span class="s2">&quot;corr_mat&quot;</span><span class="p">,</span> <span class="s2">&quot;corr_plot&quot;</span><span class="p">,</span> <span class="s2">&quot;dist_plot&quot;</span><span class="p">,</span> <span class="s2">&quot;missingval_plot&quot;</span><span class="p">]</span>


<span class="c1"># Functions</span>

<span class="c1"># Categorical Plot</span>
<div class="viewcode-block" id="cat_plot"><a class="viewcode-back" href="../../klib.html#klib.describe.cat_plot">[docs]</a><span class="k">def</span> <span class="nf">cat_plot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">top</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">bottom</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">bar_color_top</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#5ab4ac&quot;</span><span class="p">,</span>
    <span class="n">bar_color_bottom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#d8b365&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BrBG&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Two-dimensional visualization of the number and frequency of categorical features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        2D dataset that can be coerced into Pandas DataFrame. If a Pandas DataFrame is provided, the index/column \</span>
<span class="sd">    information is used to label the plots</span>
<span class="sd">    figsize : Tuple, optional</span>
<span class="sd">        Use to control the figure size, by default (16, 16)</span>
<span class="sd">    top : int, optional</span>
<span class="sd">        Show the &quot;top&quot; most frequent values in a column, by default 3</span>
<span class="sd">    bottom : int, optional</span>
<span class="sd">        Show the &quot;bottom&quot; most frequent values in a column, by default 3</span>
<span class="sd">    bar_color_top : str, optional</span>
<span class="sd">        Use to control the color of the bars indicating the most common values, by default &quot;#5ab4ac&quot;</span>
<span class="sd">    bar_color_bottom : str, optional</span>
<span class="sd">        Use to control the color of the bars indicating the least common values, by default &quot;#d8b365&quot;</span>
<span class="sd">    cmap : str, optional</span>
<span class="sd">        The mapping from data values to color space, by default &quot;BrBG&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Gridspec</span>
<span class="sd">        gs: Figure with array of Axes objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate Inputs</span>
    <span class="n">_validate_input_int</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_int</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No columns with categorical data were detected.&quot;</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>

        <span class="n">n_unique</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">value_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">lim_top</span><span class="p">,</span> <span class="n">lim_bot</span> <span class="o">=</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span>

        <span class="k">if</span> <span class="n">n_unique</span> <span class="o">&lt;</span> <span class="n">top</span> <span class="o">+</span> <span class="n">bottom</span><span class="p">:</span>
            <span class="n">lim_top</span> <span class="o">=</span> <span class="n">lim_bot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_unique</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">value_counts_top</span> <span class="o">=</span> <span class="n">value_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">lim_top</span><span class="p">]</span>
        <span class="n">value_counts_idx_top</span> <span class="o">=</span> <span class="n">value_counts_top</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">value_counts_bot</span> <span class="o">=</span> <span class="n">value_counts</span><span class="p">[</span><span class="o">-</span><span class="n">lim_bot</span><span class="p">:]</span>
        <span class="n">value_counts_idx_bot</span> <span class="o">=</span> <span class="n">value_counts_bot</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">top</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value_counts_top</span> <span class="o">=</span> <span class="n">value_counts_idx_top</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="n">bottom</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value_counts_bot</span> <span class="o">=</span> <span class="n">value_counts_idx_bot</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">value_counts_idx_top</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">value_counts_idx_bot</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[((</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Barcharts</span>
        <span class="n">ax_top</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="p">:</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_top</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">value_counts_idx_top</span><span class="p">,</span> <span class="n">value_counts_top</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_color_top</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
        <span class="n">ax_top</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">value_counts_idx_bot</span><span class="p">,</span> <span class="n">value_counts_bot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_color_bottom</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
        <span class="n">ax_top</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frame_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax_top</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

        <span class="c1"># Summary stats</span>
        <span class="n">ax_bottom</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">count</span> <span class="p">:</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_bottom</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax_bottom</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax_bottom</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frame_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax_bottom</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Unique values: </span><span class="si">{</span><span class="n">n_unique</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Top </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2"> vals: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">value_counts_top</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">value_counts_top</span><span class="p">)</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Bot </span><span class="si">{</span><span class="n">bottom</span><span class="si">}</span><span class="s2"> vals: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">value_counts_bot</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">value_counts_bot</span><span class="p">)</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax_bottom</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Heatmap</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="n">ax_hm</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="p">:])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">4.25</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.25</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_hm</span><span class="p">)</span>
    <span class="n">ax_hm</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ax_hm</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax_hm</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ax_hm</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
    <span class="n">ax_hm</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax_hm</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">)</span>
    <span class="n">ax_hm</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">)</span>

    <span class="n">gs</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Categorical data plot&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.47</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.925</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gs</span></div>


<span class="c1"># Correlation Matrix</span>
<div class="viewcode-block" id="corr_mat"><a class="viewcode-back" href="../../klib.html#klib.describe.corr_mat">[docs]</a><span class="k">def</span> <span class="nf">corr_mat</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">split</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Optional[Literal[&#39;pos&#39;, &#39;neg&#39;, &#39;above&#39;, &#39;below&#39;]] = None,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pearson&quot;</span><span class="p">,</span>  <span class="c1"># Literal[&#39;pearson&#39;, &#39;spearman&#39;, &#39;kendall&#39;] = &quot;pearson&quot;,</span>
    <span class="n">colored</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot; Returns a color-encoded correlation matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        2D dataset that can be coerced into Pandas DataFrame. If a Pandas DataFrame is provided, the index/column \</span>
<span class="sd">    information is used to label the plots</span>
<span class="sd">    split : Optional[str], optional</span>
<span class="sd">        Type of split to be performed, by default None</span>
<span class="sd">        {None, &#39;pos&#39;, &#39;neg&#39;, &#39;above&#39;, &#39;below&#39;}</span>
<span class="sd">    threshold : float, optional</span>
<span class="sd">        Value between 0 &lt;= threshold &lt;= 1, by default 0</span>
<span class="sd">    target : Optional[Union[pd.DataFrame, str]], optional</span>
<span class="sd">        Specify target for correlation. E.g. label column to generate only the correlations between each feature \</span>
<span class="sd">        and the label, by default None</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        method: {&#39;pearson&#39;, &#39;spearman&#39;, &#39;kendall&#39;}, by default &quot;pearson&quot;</span>
<span class="sd">        * pearson: measures linear relationships and requires normally distributed and homoscedastic data.</span>
<span class="sd">        * spearman: ranked/ordinal correlation, measures monotonic relationships.</span>
<span class="sd">        * kendall: ranked/ordinal correlation, measures monotonic relationships. Computationally more expensive but \</span>
<span class="sd">            more robust in smaller dataets than &#39;spearman&#39;</span>
<span class="sd">    colored : bool, optional</span>
<span class="sd">        If True the negative values in the correlation matrix are colored in red, by default True</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[pd.DataFrame, pd.Styler]</span>
<span class="sd">        If colored = True - corr: Pandas Styler object</span>
<span class="sd">        If colored = False - corr: Pandas DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate Inputs</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">colored</span><span class="p">,</span> <span class="s2">&quot;colored&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">color_negative_red</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#FF3344&quot;</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="s2">&quot;color: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">color</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">target_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">target_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">target_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target_data</span><span class="o">.</span><span class="n">name</span>

        <span class="n">corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">target_data</span><span class="p">))</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">corr</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="n">_corr_selector</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colored</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">corr</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">color_negative_red</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">na_rep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">corr</span></div>


<span class="c1"># Correlation matrix / heatmap</span>
<div class="viewcode-block" id="corr_plot"><a class="viewcode-back" href="../../klib.html#klib.describe.corr_plot">[docs]</a><span class="k">def</span> <span class="nf">corr_plot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">split</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pearson&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BrBG&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">annot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dev</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Two-dimensional visualization of the correlation between feature-columns, excluding NA values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        2D dataset that can be coerced into Pandas DataFrame. If a Pandas DataFrame is provided, the index/column \</span>
<span class="sd">        information is used to label the plots</span>
<span class="sd">    split : Optional[str], optional</span>
<span class="sd">        Type of split to be performed, by default None</span>
<span class="sd">        {None, &#39;pos&#39;, &#39;neg&#39;, &#39;above&#39;, &#39;below&#39;}</span>
<span class="sd">            * None: visualize all correlations between the feature-columns</span>
<span class="sd">            * pos: visualize all positive correlations between the feature-columns above the threshold</span>
<span class="sd">            * neg: visualize all negative correlations between the feature-columns below the threshold</span>
<span class="sd">            * above: visualize all correlations between the feature-columns for which abs(corr) &gt; threshold is True</span>
<span class="sd">            * below: visualize all correlations between the feature-columns for which abs(corr) &lt; threshold is True</span>
<span class="sd">    threshold : float, optional</span>
<span class="sd">        Value between 0 &lt;= threshold &lt;= 1, by default 0</span>
<span class="sd">    target : Optional[Union[pd.Series, str]], optional</span>
<span class="sd">        Specify target for correlation. E.g. label column to generate only the correlations between each feature \</span>
<span class="sd">        and the label, by default None</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        method: {&#39;pearson&#39;, &#39;spearman&#39;, &#39;kendall&#39;}, by default &quot;pearson&quot;</span>
<span class="sd">            * pearson: measures linear relationships and requires normally distributed and homoscedastic data.</span>
<span class="sd">            * spearman: ranked/ordinal correlation, measures monotonic relationships.</span>
<span class="sd">            * kendall: ranked/ordinal correlation, measures monotonic relationships. Computationally more expensive \</span>
<span class="sd">                but more robust in smaller dataets than &#39;spearman&#39;.</span>
<span class="sd">    cmap : str, optional</span>
<span class="sd">        The mapping from data values to color space, matplotlib colormap name or object, or list of colors, by default \</span>
<span class="sd">        &quot;BrBG&quot;</span>
<span class="sd">    figsize : Tuple, optional</span>
<span class="sd">        Use to control the figure size, by default (12, 10)</span>
<span class="sd">    annot : bool, optional</span>
<span class="sd">        Use to show or hide annotations, by default True</span>
<span class="sd">    dev : bool, optional</span>
<span class="sd">        Display figure settings in the plot by setting dev = True. If False, the settings are not displayed, by \</span>
<span class="sd">        default False</span>

<span class="sd">    **kwargs: optional</span>
<span class="sd">        Additional elements to control the visualization of the plot, e.g.:</span>

<span class="sd">        * mask: bool, default True</span>
<span class="sd">        If set to False the entire correlation matrix, including the upper triangle is shown. Set dev = False in this \</span>
<span class="sd">        case to avoid overlap.</span>
<span class="sd">        * vmax: float, default is calculated from the given correlation coefficients.</span>
<span class="sd">        Value between -1 or vmin &lt;= vmax &lt;= 1, limits the range of the colorbar.</span>
<span class="sd">        * vmin: float, default is calculated from the given correlation coefficients.</span>
<span class="sd">        Value between -1 &lt;= vmin &lt;= 1 or vmax, limits the range of the colorbar.</span>
<span class="sd">        * linewidths: float, default 0.5</span>
<span class="sd">        Controls the line-width inbetween the squares.</span>
<span class="sd">        * annot_kws: dict, default {&#39;size&#39; : 10}</span>
<span class="sd">        Controls the font size of the annotations. Only available when annot = True.</span>
<span class="sd">        * cbar_kws: dict, default {&#39;shrink&#39;: .95, &#39;aspect&#39;: 30}</span>
<span class="sd">        Controls the size of the colorbar.</span>
<span class="sd">        * Many more kwargs are available, i.e. &#39;alpha&#39; to control blending, or options to adjust labels, ticks ...</span>

<span class="sd">        Kwargs can be supplied through a dictionary of key-value pairs (see above).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax: matplotlib Axes</span>
<span class="sd">        Returns the Axes object with the plot for further tweaking.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate Inputs</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">annot</span><span class="p">,</span> <span class="s2">&quot;annot&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="n">corr_mat</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">colored</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>

    <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="c1"># Specify kwargs for the heatmap</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="n">mask</span><span class="p">,</span>
        <span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">cmap</span><span class="p">,</span>
        <span class="s2">&quot;annot&quot;</span><span class="p">:</span> <span class="n">annot</span><span class="p">,</span>
        <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax</span><span class="p">,</span>
        <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="n">vmin</span><span class="p">,</span>
        <span class="s2">&quot;linewidths&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;annot_kws&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
        <span class="s2">&quot;cbar_kws&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Draw heatmap with mask and default settings</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature-correlation (</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>

    <span class="c1"># Settings</span>
    <span class="k">if</span> <span class="n">dev</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\</span>
<span class="s2">            Settings (dev-mode): </span><span class="se">\n\</span>
<span class="s2">            - split-mode: </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - threshold: </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - method: </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - annotations: </span><span class="si">{</span><span class="n">annot</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - cbar: </span><span class="se">\n\</span>
<span class="s2">                - vmax: </span><span class="si">{</span><span class="n">vmax</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">                - vmin: </span><span class="si">{</span><span class="n">vmin</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - linewidths: </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;linewidths&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - annot_kws: </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;annot_kws&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\</span>
<span class="s2">            - cbar_kws: </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_kws&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<span class="c1"># Distribution plot</span>
<div class="viewcode-block" id="dist_plot"><a class="viewcode-back" href="../../klib.html#klib.describe.dist_plot">[docs]</a><span class="k">def</span> <span class="nf">dist_plot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">mean_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">fill_range</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">),</span>
    <span class="n">hist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">showall</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kde_kws</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rug_kws</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_kws</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">font_kws</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Two-dimensional visualization of the distribution of numerical features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        2D dataset that can be coerced into Pandas DataFrame. If a Pandas DataFrame is provided, the index/column \</span>
<span class="sd">    information is used to label the plots</span>
<span class="sd">    mean_color : str, optional</span>
<span class="sd">        Color of the vertical line indicating the mean of the data, by default &quot;orange&quot;</span>
<span class="sd">    figsize : Tuple, optional</span>
<span class="sd">        Controls the figure size, by default (14, 2)</span>
<span class="sd">    fill_range : Tuple, optional</span>
<span class="sd">        Set the quantiles for shading. Default spans 95% of the data, which is about two std. deviations \</span>
<span class="sd">        above and below the mean, by default (0.025, 0.975)</span>
<span class="sd">    hist : bool, optional</span>
<span class="sd">        Set to True to display histogram bars in the plot, by default False</span>
<span class="sd">    bins : int, optional</span>
<span class="sd">        Specification of the number of hist bins. Requires hist = True, by default 10</span>
<span class="sd">    showall : bool, optional</span>
<span class="sd">        Set to True to remove the output limit of 20 plots, by default False</span>
<span class="sd">    kde_kws : Dict[str, Any], optional</span>
<span class="sd">        Keyword arguments for kdeplot(), by default {&#39;color&#39;: &#39;k&#39;, &#39;alpha&#39;: 0.7, &#39;linewidth&#39;: 1}</span>
<span class="sd">    rug_kws : Dict[str, Any], optional</span>
<span class="sd">        Keyword arguments for rugplot(), by default {&#39;color&#39;: &#39;brown&#39;, &#39;alpha&#39;: 0.5, &#39;linewidth&#39;: 2, &#39;height&#39;: 0.04}</span>
<span class="sd">    fill_kws : Dict[str, Any], optional</span>
<span class="sd">        Keyword arguments to control the fill, by default {&#39;color&#39;: &#39;brown&#39;, &#39;alpha&#39;: 0.1}</span>
<span class="sd">    font_kws : Dict[str, Any], optional</span>
<span class="sd">        Keyword arguments to control the font, by default {&#39;color&#39;:  &#39;#111111&#39;, &#39;weight&#39;: &#39;normal&#39;, &#39;size&#39;: 11}</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [type]</span>
<span class="sd">        [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate Inputs</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">fill_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;fill_range_lower&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">fill_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;fill_range_upper&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_validate_input_smaller</span><span class="p">(</span><span class="n">fill_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fill_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;fill_range&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="s2">&quot;hist&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_int</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
    <span class="n">_validate_input_range</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">showall</span><span class="p">,</span> <span class="s2">&quot;showall&quot;</span><span class="p">)</span>

    <span class="c1"># Handle dictionary defaults</span>
    <span class="n">kde_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">}</span> <span class="k">if</span> <span class="n">kde_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kde_kws</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">rug_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;brown&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">}</span> <span class="k">if</span> <span class="n">rug_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rug_kws</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">fill_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;brown&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span> <span class="k">if</span> <span class="n">fill_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fill_kws</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">font_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#111111&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">}</span> <span class="k">if</span> <span class="n">font_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">font_kws</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No columns with numeric data were detected.&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">showall</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Note: The number of numerical features is very large (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s2">), please consider splitting the data. &quot;</span>
            <span class="s2">&quot;Showing plots for the first 20 numerical features. Override this by setting showall=True.&quot;</span>
        <span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">dropped_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dropped_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dropped </span><span class="si">{</span><span class="n">dropped_values</span><span class="si">}</span><span class="s2"> missing values from column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span>
            <span class="n">col_data</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
            <span class="n">hist</span><span class="o">=</span><span class="n">hist</span><span class="p">,</span>
            <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">kde_kws</span><span class="o">=</span><span class="n">kde_kws</span><span class="p">,</span>
            <span class="n">rug_kws</span><span class="o">=</span><span class="n">rug_kws</span><span class="p">,</span>
            <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;histtype&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="c1"># Vertical lines and fill</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xydata</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span>
            <span class="n">y</span><span class="p">,</span>
            <span class="n">where</span><span class="o">=</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">col_data</span><span class="p">,</span> <span class="n">fill_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">col_data</span><span class="p">,</span> <span class="n">fill_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))),</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fill_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% - </span><span class="si">{</span><span class="n">fill_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">fill_kws</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">tstd</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mean_color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">col_data</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">col_data</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.3&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;median&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">mean</span> <span class="o">-</span> <span class="n">std</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">std</span><span class="p">],</span>
            <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ymax</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="n">std</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mean</span> <span class="o">+</span> <span class="n">std</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)],</span>
            <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u03BC</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="se">\u03C3</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span>

        <span class="c1"># Annotations and legend</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">font_kws</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Std. dev: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">font_kws</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Skew: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">col_data</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">font_kws</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.01</span><span class="p">,</span>
            <span class="mf">0.4</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Kurtosis: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">col_data</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># Excess Kurtosis</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="n">font_kws</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Count: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col_data</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">font_kws</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<span class="c1"># Missing value plot</span>
<div class="viewcode-block" id="missingval_plot"><a class="viewcode-back" href="../../klib.html#klib.describe.missingval_plot">[docs]</a><span class="k">def</span> <span class="nf">missingval_plot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PuBuGn&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="n">sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">spine_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#EEEEEE&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Two-dimensional visualization of the missing values in a dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pd.DataFrame</span>
<span class="sd">        2D dataset that can be coerced into Pandas DataFrame. If a Pandas DataFrame is provided, the index/column \</span>
<span class="sd">    information is used to label the plots</span>
<span class="sd">    cmap : str, optional</span>
<span class="sd">        Any valid colormap can be used. E.g. &#39;Greys&#39;, &#39;RdPu&#39;. More information can be found in the matplotlib \</span>
<span class="sd">        documentation, by default &quot;PuBuGn&quot;</span>
<span class="sd">    figsize : Tuple, optional</span>
<span class="sd">        Use to control the figure size, by default (20, 20)</span>
<span class="sd">    sort : bool, optional</span>
<span class="sd">        Sort columns based on missing values in descending order and drop columns without any missing values, \</span>
<span class="sd">        by default False</span>
<span class="sd">    spine_color : str, optional</span>
<span class="sd">        Set to &#39;None&#39; to hide the spines on all plots or use any valid matplotlib color argument, by default &quot;#EEEEEE&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    GridSpec</span>
<span class="sd">        gs: Figure with array of Axes objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate Inputs</span>
    <span class="n">_validate_input_bool</span><span class="p">(</span><span class="n">sort</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
        <span class="n">mv_cols_sorted</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">final_cols</span> <span class="o">=</span> <span class="n">mv_cols_sorted</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">mv_cols_sorted</span><span class="p">[</span><span class="n">mv_cols_sorted</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">final_cols</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Displaying only columns with missing values.&quot;</span><span class="p">)</span>

    <span class="c1"># Identify missing values</span>
    <span class="n">mv_total</span><span class="p">,</span> <span class="n">mv_rows</span><span class="p">,</span> <span class="n">mv_cols</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">mv_cols_ratio</span> <span class="o">=</span> <span class="n">_missing_vals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">total_datapoints</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">mv_total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No missing values found in the dataset.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create figure and axes</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:])</span>
        <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">5</span><span class="p">:])</span>

        <span class="c1"># ax1 - Barplot</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)(</span><span class="n">mv_cols</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mv_cols</span><span class="p">))</span>  <span class="c1"># color bars by height</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mv_cols</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">mv_cols_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frame_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mv_cols</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mv_cols_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">PercentFormatter</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># annotate values on top of the bars</span>
        <span class="k">for</span> <span class="n">rect</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">patches</span><span class="p">,</span> <span class="n">mv_cols</span><span class="p">):</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="mf">0.1</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">height</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                <span class="n">rotation</span><span class="o">=</span><span class="s2">&quot;90&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;11&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">spine_color</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="c1"># ax2 - Heatmap</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">spine_color</span><span class="p">)</span>

        <span class="c1"># ax3 - Summary</span>
        <span class="n">fontax3</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#111111&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frame_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Total: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">total_datapoints</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontax3</span>
        <span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.675</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mv_total</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontax3</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.025</span><span class="p">,</span>
            <span class="mf">0.475</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Relative: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mv_total</span><span class="o">/</span><span class="n">total_datapoints</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="n">fontax3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.025</span><span class="p">,</span>
            <span class="mf">0.275</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Max-col: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mv_cols</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="n">fontax3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.025</span><span class="p">,</span>
            <span class="mf">0.075</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Max-row: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mv_rows</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="n">fontax3</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># ax4 - Scatter plot</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax4</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">spine_color</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">ax4</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mv_rows</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mv_rows</span><span class="p">)),</span> <span class="n">s</span><span class="o">=</span><span class="n">mv_rows</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">mv_rows</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mv_rows</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># limit and invert y-axis</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">mv_rows</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">gs</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Missing value plot&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#111111&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gs</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Andreas Kanz

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>